{"version":3,"file":"1142.b8648cfb3db315d4.js","mappings":"wPAgBIA,MAAA,0BAA4EA,MAAA,GAE5EA,kCAFwDA,MAAA,QAAAC,GAAoBD,cAAA,GAAAC,EAAAC,OAAA,8CAuC3EF,MAAA,mBACCA,MAAA,mBAAAA,MAAAG,GAAA,MAAAC,EAAAJ,QAAAK,MAAAC,EAAAN,QAAA,OAAAA,MAASM,EAAAC,iBAAAH,GAAmB,GAC5BJ,MAAA,iBACAA,MAAA,gBACDA,kCAlBAA,MAFF,eAEEA,CAFyF,mBAEzFA,CADe,yBACiBA,MAAA,GAAsBA,QACtDA,MAAA,cACCA,MAAA,kBACDA,QACAA,MAAA,cACCA,MAAA,kBACDA,QAEKA,MADA,aACAA,CADU,cAERA,MAAA,sBAGJA,UAEHA,MAAA,GAAAQ,EAAA,qBAMFR,0CAtBsEA,MAAA,gBAAAI,GAEpCJ,MAAA,GAAAA,MAAA,cAAAI,EAAA,MAcsBJ,MAAA,GAAAA,MAAA,OAAAM,EAAAG,aAAAC,OAAA,ICrCrD,MAAOC,UAA2BC,IActCC,YACSC,EACCC,EACAC,EACAC,EACRC,EACQC,GAERC,MAAMF,GAPCG,KAAAP,YACCO,KAAAN,cACAM,KAAAL,cACAK,KAAAJ,UAEAI,KAAAF,YAnBVE,KAAAC,MAAgB,GAChBD,KAAAE,aAA8B,GAC9BF,KAAAG,cAAkC,GAClCH,KAAAI,UAAwB,GACxBJ,KAAAK,WAA6B,GAC7BL,KAAAM,KAAO,IAAIC,KACXP,KAAAQ,MAAQ,IAAID,KACVP,KAAKM,KAAKG,UAA4C,IAAhCT,KAAKM,KAAKI,qBAElCV,KAAAW,cAAiC,GAa/BX,KAAKY,OAASZ,KAAKL,YAAYkB,MAAM,CACnCC,UAAW,CAAC,GAAIC,KAAWC,UAC3BC,OAAQ,CAAC,GAAIF,KAAWC,UACxBE,MAAO,CAAC,GAAIH,KAAWC,UACvBG,MAAO,CAAC,GAAIJ,KAAWC,UACvBI,WAAY,CAAC,IACbhB,UAAWJ,KAAKL,YAAY0B,MAAM,CAACrB,KAAKsB,kBAE5C,CAEAA,eACE,OAAOtB,KAAKL,YAAYkB,MAAM,CAE5BU,IAAK,CAAC,GAAIR,KAAWC,UACrBG,MAAO,CAAC,GAAIJ,KAAWC,UACvBI,WAAY,CAAC,KAEjB,CAEA,gBAAIhC,GACF,OAAOY,KAAKY,OAAOY,IAAI,YACzB,CAEAC,UACEC,QAAQC,IAAI3B,KAAKY,OAAOgB,MAC1B,CACAC,WACE7B,KAAKJ,QAAQkC,mBAAmBC,KAAK,IAAM/B,KAAKgC,kBAChD,MAAMC,EAAgBjC,KAAKQ,MAAM0B,SAASC,MAAM,KAAK,GACrDnC,KAAKY,OAAOwB,WAAW,CAAElB,MAAOe,GAClC,CAEAD,iBACEhC,KAAKqC,UACLrC,KAAKJ,QAAQ0C,kBAAkBC,UAAWC,IACxCxC,KAAKK,WAAamC,GAAQ,GAC1BxC,KAAKyC,SAAO,EAEhB,CAEAC,SAASC,GACP,MAAMC,EAA2BD,EAAME,OAAOjB,MAC9C,GAAIgB,EAAY,CACd,IAAI9B,EACJA,EAAYd,KAAKK,YAAcL,KAAKK,WAAWyC,KAAMC,GAASA,EAAKlE,SAAW+D,EAAW/D,SAAW,GACpGmB,KAAKY,OAAOwB,WAAW,CAAEnB,OAAQH,EAAUkC,iBAC7C,CACF,CAEEC,cAAcN,EAAoBO,GAChC,MAAMC,EAAiBR,EAAME,OAAOjB,MACpC,GAAIuB,EAAQ,CACV,MAAMC,EAAqBpD,KAAKY,OAAOyC,SAASjD,UAG1C6B,GAFoBmB,EAAQE,GAAGJ,GAAGtB,MAAMT,MAExBnB,KAAKY,OAAOgB,MAAMV,OAClCqC,EAAcvD,KAAKY,OAAOgB,MAAMR,WACtCgC,EAAQE,GAAGJ,GAAGd,WAAW,CACvBb,IAAKU,EACLd,MAAOgC,EACP/B,WAAYmC,GAEhB,CACF,CAEIC,OAAOC,GAAW,IAAAC,EAAA1D,KAAA,SAAA2D,KAAA,wBACID,EAAKhE,YAAYkE,OAAO,CAChDC,OAAQ,8BACRC,QAAS,CACP,CACEC,KAAM,UACNC,KAAM,OACNC,QAASA,KACPP,EAAKQ,KAAKT,EAAM,GAGpB,CACEM,KAAM,WACNC,KAAM,QACNG,KAAM,cAIMC,SAAU,EAlBN,EAmB1B,CAEEF,KAAKT,GACH,IAAIvC,EAAQ,IAAIX,KAAKP,KAAKC,MAAMoE,OAASrE,KAAKQ,OAC9CR,KAAKC,MAAMoE,MAAQnD,EAAMoD,eAAe,QAAS,CAC/CC,SAAU,wBAEZvE,KAAKwE,UAAUf,GACfzD,KAAKJ,QAAQsE,KAAKlE,KAAKC,MAAOD,KAAKG,eAAeoC,UAAU,CAC1DkC,KAAOjC,IACLxC,KAAK0E,aAAa,0BAClB1E,KAAKyC,UAELzC,KAAK2E,SAAS3E,KAAKG,cAAa,EAElCyE,MAAQC,IACN7E,KAAK0E,aAAa,8BAClBhD,QAAQC,IAAI,UAAWkD,GACvB7E,KAAKyC,SAAO,IAGhBzC,KAAKqC,SACP,CAEEmC,UAAUf,GAERzD,KAAKC,MAAM6E,UAAYrB,EAAO3C,UAAUjC,OACxCmB,KAAKC,MAAMoE,MAAQZ,EAAOvC,MAC1BlB,KAAKC,MAAMpB,OAAS4E,EAAOxC,OAC3BjB,KAAKC,MAAM8E,MAAQtB,EAAOtC,MAC1BnB,KAAKC,MAAM+E,WAAavB,EAAOrC,WAE/B,IAAIhB,EAAYqD,EAAOrD,UACnBJ,KAAKG,cAAgB,GACjBC,GACFA,EAAU6E,QAASlC,IACnB,IAAIF,EAAwB,GAC5BA,EAAOiC,UAAYrB,EAAO3C,UAAUjC,OACpCgE,EAAOwB,MAAQtB,EAAKxB,IACpBsB,EAAOhE,OAAS4E,EAAOxC,OACvB4B,EAAOkC,MAAQhC,EAAK5B,MACpB0B,EAAOmC,WAAajC,EAAK3B,WAEvBpB,KAAKG,cAAc+E,KAAKrC,EAAM,EAGxC,CAGM8B,SAASQ,GAAmB,IAAAC,EAAApF,KAAA,SAAA2D,KAAA,wBACNyB,EAAK1F,YAAYkE,OAAO,CAChDC,OAAQ,iCACRC,QAAS,CACP,CACEC,KAAM,aACNC,KAAM,cACNG,KAAM,QACNF,QAASA,KACPmB,EAAKzE,cAAcuE,QAAQC,GAC3BC,EAAKxE,OAAOyE,QACZ,MAAMpD,EAAgBmD,EAAK5E,MAAM0B,SAASC,MAAM,KAAK,GACrDiD,EAAKxE,OAAOwB,WAAW,CAAElB,MAAOe,GAAe,GAGnD,CACE8B,KAAM,QACNC,KAAM,YACNG,KAAM,UACNF,QAASA,KACPmB,EAAKzE,cAAcuE,QAAQC,GAC3BC,EAAKE,QAAQF,EAAKzE,cAAa,OAKrByD,SAAU,EA1BI,EA2BlC,CAEAlF,iBAAiBgE,GACYlD,KAAKY,OAAOyC,SAASjD,UACxCmF,SAASrC,EACnB,CAEAsC,mBACE,MAAMpC,EAAqBpD,KAAKY,OAAOyC,SAASjD,UAChD,IAAIqF,EAAmB,EACvBrC,EAAQC,SAAS4B,QAASlC,IACxB0C,GAAY1C,EAAKnB,MAAMT,QAEzBiC,EAAQ8B,KAAKlF,KAAKsB,gBAClBtB,KAAK0F,oBAAoBD,EAC3B,CAEAC,oBAAoBvC,EAAiB,GAEnC,MAAMwC,EADQ3F,KAAKY,OAAOgB,MAAMT,MACPgC,EACnBC,EAAqBpD,KAAKY,OAAOyC,SAASjD,UAC1C6B,EAAgBjC,KAAKQ,MAAM0B,SAASC,MAAM,KAAK,GACrDiB,EAAQE,GAAGF,EAAQ/D,OAAQ,GAAI+C,WAAW,CACxCb,IAAKU,EACLd,MAAOwE,GAEX,CAGFjB,aAAakB,GACX5F,KAAKF,UAAU+F,aAAaD,EAAU,MACxC,CAEAE,QACE9F,KAAKP,UAAUgD,QAAQ,KAAM,SAC/B,CACA6C,QAAQrF,GACND,KAAKP,UAAUgD,QAAQxC,EAAO,UAChC,KA7NWX,0CAAkBX,MAAAoH,MAAApH,MAAAoH,MAAApH,MAAAqH,MAAArH,MAAAsH,KAAAtH,MAAAoH,MAAApH,MAAAuH,KAAA,0BAAlB5G,EAAkB6G,UAAA,qBAAAC,YAAA,EAAAC,SAAA,CAAA1H,OAAA2H,MAAA,GAAAC,KAAA,EAAAC,OAAA,i3CAAAC,SAAA,SAAAC,EAAAC,GAAA,EAAAD,IDhB7B/H,MAFF,eAEEA,CAFU,gBAEVA,CADY,eACDA,MAAA,oBAAcA,QAExBA,MADD,kBACCA,CADyB,kBACFA,MAAA,0BAASgI,EAAAb,OAAO,GACtCnH,MAAA,gBAIJA,cAGCA,MADD,kBACCA,CADgC,YACLA,MAAA,6BAAYgI,EAAAnD,OAAAmD,EAAA/F,OAAAgB,MAAoB,GAEzDjD,MADD,aACCA,CADS,mBACmEA,MAAA,qBAAAiI,GAAA,OAAaD,EAAAjE,SAAAkE,EAAgB,GAExGjI,MAAA,GAAAkI,EAAA,2BAIFlI,UACAA,MAAA,eACCA,MAAA,kBAGDA,QACAA,MAAA,eAECA,MAAA,kBACDA,QAECA,MADD,cACCA,CADS,kBACgFA,MAAA,qBAAAiI,GAAA,OAAaD,EAAA1D,cAAA2D,EAAsB,EAAE,GAC/HjI,UACAA,MAAA,eACCA,MAAA,sBAEDA,QAEAA,MAAA,aACCA,MAAA,GAAAmI,EAAA,mBAuBDnI,QAEAA,MAAA,oBACCA,MAAA,0BAASgI,EAAAnB,kBAAkB,GAC3B7G,MAAA,kBACAA,MAAA,uBACAA,QACDA,MAAA,oBAAoEA,MAAA,cAEtEA,mBA3DOA,MAAA,GAAAA,MAAA,YAAAgI,EAAA/F,QAIsCjC,MAAA,GAAAA,MAAA,UAAAgI,EAAAtG,YAuBb1B,MAAA,IAAAA,MAAA,UAAAgI,EAAAvH,aAAAiE,UA8BW1E,MAAA,GAAAA,MAAA,YAAAgI,EAAA/F,OAAAmG,qPE3DzCpI,MADD,cACCA,CADiF,sBACjEA,MAAA,mBAAAA,MAAAqI,GAAA,MAAAC,EAAAtI,QAAA,OAAAA,MAASsI,EAAAC,UAAU,CAAAC,IAAM,QAAO,GAC9CxI,MAAA,iBAEDA,oCAeEA,MAHH,aAGGA,CAH2C,cAG3CA,CAFS,WAETA,CAD6B,QACzBA,MAAA,GACLA,UACAA,MAAA,OAAGA,MAAA,uBAELA,sCAJOA,MAAA,GAAAA,MAAA,GAAAyI,EAAAvI,OAAA,IAAAuI,EAAApC,WAAA,KAAAoC,EAAApC,WAAA,YAEFrG,MAAA,GAAAA,MAAA,GAAAyI,EAAAtC,UAAA,OAAAnG,MAAA,IAAAyI,EAAArC,OAAA,+BARLpG,MADD,mBACCA,CADsE,yBAErEA,MAAA,mBACDA,QACAA,MAAA,EAAA0I,EAAA,kBAQD1I,kCAVEA,MAAA,GAAAA,MAAA,IAAAA,MAAA,IAAA2I,EAAAzD,OAAA,kBAE4BlF,MAAA,GAAAA,MAAA,UAAA2I,EAAAC,UCTzB,MAAOC,EAKXhI,YACSC,EACAgI,EACC7H,EACA8H,GAHD1H,KAAAP,YACAO,KAAAyH,UACCzH,KAAAJ,UACAI,KAAA0H,WARV1H,KAAA2H,MAAyB,GACzB3H,KAAA4H,YAA+B,GAC/B5H,KAAAmE,KAAe,EAQf,CAEAtC,WACE7B,KAAKJ,QAAQkC,mBAAmBC,KAAK,IAAM/B,KAAK6H,WAChD,MAAMC,EAAOC,aAAaC,QAAQ,QAClChI,KAAKmE,KAAO2D,EAAOG,KAAKC,MAAMJ,GAAMK,KAAO,EAC7C,CAEAC,UAAUzF,GACR3C,KAAKJ,QAAQyI,oBAAoB9F,UAAWQ,IAC1C/C,KAAK2H,MAAQ,IAAI5E,GACjB/C,KAAK4H,YAAc,IAAI5H,KAAK2H,OAC3BhF,EAAM2F,OAAmCC,UAAQ,EAEtD,CAEMV,UAAO,IAAAnE,EAAA1D,KAAA,SAAA2D,KAAA,YACXD,EAAKgE,SAASrF,gBACRqB,EAAK9D,QAAQyI,oBAAoB9F,UAAWQ,IAChDW,EAAKiE,MAAQ,IAAI5E,GACjBW,EAAKkE,YAAc,IAAIlE,EAAKiE,OAC5BjE,EAAKgE,SAASjF,SAAO,EACpB,EANQ,EAOb,CAEA+F,SAASC,GAGPzI,KAAK2H,MAAQ3H,KAAK4H,YAGlB,MAAMc,EAAMD,EAAGH,OAAO1G,MAElB8G,GAAqB,IAAdA,EAAIC,SACb3I,KAAK2H,MAAQ3H,KAAK2H,MAAMiB,OAAOC,GAE3BA,EAAK/D,WAAa+D,EAAK/D,UAAUgE,cAAcC,QAAQL,EAAII,gBAAiB,GAC5ED,EAAKhK,QAAUgK,EAAKhK,OAAOiK,cAAcC,QAAQL,EAAII,gBAAiB,GAI9E,CAEM5B,UAAUrE,GAAW,IAAAuC,EAAApF,KAAA,SAAA2D,KAAA,YACzB,MAAMqF,QAAc5D,EAAK3F,UAAUmE,OAAO,CACxCqF,UAAW3J,EACX4J,eAAgB,CAAErG,OAASA,EAAOA,UAEpCmG,EAAM5E,UACN,MAAQrB,OAAMoB,cAAe6E,EAAMG,gBACtB,YAAThF,GAAsBpB,GAAQqG,MAAMC,QAAQtG,KAC9CqC,EAAKuC,MAAMzC,QAAQnC,GACnBqC,EAAKuC,MAAQ,IAAIvC,EAAKuC,OACtBvC,EAAKwC,YAAc,IAAIxC,EAAKuC,OAC5BvC,EAAKxF,QAAQ0J,eAAe7E,KAAKW,EAAKuC,OACvC,EAZwB,EAa3B,KAnEWH,0CAAU7I,MAAAoH,MAAApH,MAAAoH,MAAApH,MAAAqH,KAAArH,MAAAsH,KAAA,0BAAVuB,EAAUrB,UAAA,iBAAAC,YAAA,EAAAE,MAAA,GAAAC,KAAA,EAAAC,OAAA,wcAAAC,SAAA,SAAAC,EAAAC,GAAA,EAAAD,IDdnB/H,MAFJ,iBAEIA,CAF6B,kBAE7BA,CAD2B,eAEzBA,MAAA,cAGNA,YACAA,MAAA,mBAECA,MAAA,EAAA4K,EAAA,iBAMC5K,MADD,oBACCA,CADgB,qBACDA,MAAA,oBAAAiI,GAAA,OAAYD,EAAA6B,SAAA5B,EAAgB,GAC5CjI,UACAA,MAAA,qBAA4BA,MAAA,sBAAAiI,GAAA,OAAcD,EAAAyB,UAAAxB,EAAiB,GAC1DjI,MAAA,6BAEDA,QACAA,MAAA,GAAA6K,EAAA,4CAaD7K,eAlCYA,MAAA,kBAS+CA,MAAA,GAAAA,MAAA,iBAAAgI,EAAAxC,MAYzBxF,MAAA,GAAAA,MAAA,UAAAA,MAAA,KAAAgI,EAAAgB,MAAA,+JEjBlC,MAAM8B,EAAiB,CACrB,CACEC,KAAM,GACNT,UAAWzB,IAQT,MAAOmC,qDAAuB,yBAAvBA,gCAHDC,KAAaC,SAASJ,GACtBG,QCMN,MAAOE,+CAAgB,yBAAhBA,gCARTC,KACAC,KACAC,KACAN","names":["i0","categoria_r1","Nombre","_r2","i_r3","index","ctx_r3","removeInputField","AddGastosComponent_section_21_ion_button_11_Template","conceptoForm","length","AddGastosComponent","LoadingUtil","constructor","modalCtrl","actionSheet","formBuilder","service","loadingCtrl","toastCtrl","super","this","gasto","gastoDetalle","gastoDetalles","conceptos","categorias","date","Date","today","getTime","getTimezoneOffset","gastosConfirm","fields","group","categoria","Validators","required","nombre","fecha","monto","comentario","array","frmConceptos","mes","get","logForm","console","log","value","ngOnInit","getSpreadSheetId","then","initCategorias","formattedDate","toJSON","split","patchValue","showing","getCategoriaDef","subscribe","resp","dismiss","onChange","event","_categoria","detail","find","data","PersonaServicio","onChangeMonto","i","_monto","control","controls","at","_comentario","onSave","_gasto","_this","_asyncToGenerator","create","header","buttons","text","icon","handler","save","role","present","Fecha","toLocaleString","timeZone","fillEvent","next","meesageToast","calOther","error","err","Categoria","Monto","Comentario","forEach","push","_gastosDetalle","_this2","reset","confirm","removeAt","addNewInputField","sumMonto","updateMountConcepto","newMonto","_message","presentToast","close","i1","i2","i3","i4","selectors","standalone","features","decls","vars","consts","template","rf","ctx","$event","AddGastosComponent_ion_select_option_11_Template","AddGastosComponent_section_21_Template","valid","_r1","ctx_r1","openModal","new","detail_r3","GastosPage_ion_item_group_10_ion_item_4_Template","item_r4","details","GastosPage","navCtrl","loadUtil","items","itemsBackup","getdata","user","localStorage","getItem","JSON","parse","ROLE","doRefresh","getFullDataDetail","target","complete","getItems","ev","val","trim","filter","item","toLowerCase","indexOf","modal","component","componentProps","onWillDismiss","Array","isArray","gastosDetalle$","GastosPage_ion_fab_5_Template","GastosPage_ion_item_group_10_Template","routes","path","GastosPageRoutingModule","RouterModule","forChild","GastosPageModule","IonicModule","CommonModule","FormsModule"],"ignoreList":[],"sourceRoot":"webpack:///","sources":["./src/app/components/add-gastos/add-gastos.component.html","./src/app/components/add-gastos/add-gastos.component.ts","./src/app/pages/gastos/gastos.page.html","./src/app/pages/gastos/gastos.page.ts","./src/app/pages/gastos/gastos-routing.module.ts","./src/app/pages/gastos/gastos.module.ts"],"sourcesContent":["<ion-header>\n\t<ion-toolbar>\n\t\t<ion-title>Agregar Gastos</ion-title>\n\t\t<ion-buttons slot=\"start\">\n\t\t\t<ion-button ion-button (click)=\"close()\">\n\t\t\t\t<ion-icon name=\"close\"></ion-icon>\n\t\t\t</ion-button>\n\t\t</ion-buttons>\n\t</ion-toolbar>\n</ion-header>\n\n<ion-content class=\"ion-padding\">\n\t<form [formGroup]=\"fields\" (ngSubmit)=\"onSave(fields.value)\">\n\t\t<ion-item>\n\t\t\t<ion-select label=\"Categoria\" labelPlacement=\"floating\" interface=\"popover\" (ionChange)=\"onChange($event)\"\n\t\t\t\tformControlName=\"categoria\" placeholder=\"Seleciona categoria\">\n\t\t\t\t<ion-select-option *ngFor=\"let categoria of categorias\" [value]=\"categoria\">{{ categoria.Nombre\n\t\t\t\t\t}}\n\t\t\t\t</ion-select-option>\n\t\t\t</ion-select>\n\t\t</ion-item>\n\t\t<ion-item>\n\t\t\t<ion-input label=\"Concepto\" labelPlacement=\"floating\" type=\"text\" formControlName=\"nombre\"\n\t\t\t\tplaceholder=\"Nombre o Concepto\">\n\t\t\t</ion-input>\n\t\t</ion-item>\n\t\t<ion-item>\n\t\t\t<!-- <ion-datetime displayFormat=\"DD/MMM/YYYY\" formControlName=\"fecha\"></ion-datetime> -->\n\t\t\t<ion-input label=\"Fecha\" labelPlacement=\"floating\" id=\"fecha\" type=\"date\" formControlName=\"fecha\"></ion-input>\n\t\t</ion-item>\n\t\t<ion-item>\n\t\t\t<ion-input label=\"Monto\" labelPlacement=\"floating\" type=\"number\" formControlName=\"monto\" (ionChange)=\"onChangeMonto($event, 0)\"></ion-input>\n\t\t</ion-item>\n\t\t<ion-item>\n\t\t\t<ion-textarea label=\"Comentario\" labelPlacement=\"floating\" formControlName=\"comentario\" placeholder=\"comentario\">\n\t\t\t</ion-textarea>\n\t\t</ion-item>\n\t\t<!-- Detail -->\n\t\t<div formArrayName=\"conceptos\" margin-bottom>\n\t\t\t<section *ngFor=\"let control of conceptoForm.controls; let i = index\" [formGroupName]=\"i\" >\n\t\t\t\t<ion-item-group>\n\t\t\t\t\t<ion-item-divider color=\"light\">Conceptos #{{ i + 1 }}</ion-item-divider>\n\t\t\t\t\t<ion-item>\n\t\t\t\t\t\t<ion-input label=\"Mes:\" labelPlacement=\"floating\" id=\"mes\" type=\"date\" maxlength=\"50\" formControlName=\"mes\"></ion-input>\n\t\t\t\t\t</ion-item>\n\t\t\t\t\t<ion-item>\n\t\t\t\t\t\t<ion-input label=\"Monto:\" labelPlacement=\"floating\"  id=\"monto\" type=\"number\" maxlength=\"50\" formControlName=\"monto\"></ion-input>\n\t\t\t\t\t</ion-item>\n          <ion-item>\n          <ion-item>\n            <ion-textarea label=\"Comentario\" labelPlacement=\"floating\" formControlName=\"comentario\" placeholder=\"comentario\">\n            </ion-textarea>\n          </ion-item>\n        </ion-item>\n\t\t\t\t\t<!-- Allow generated input field to be removed -->\n\t\t\t\t\t<ion-button size=\"small\" fill=\"clear\" color=\"danger\"\t*ngIf=\"conceptoForm.length > 1\"\n\t\t\t\t\t\t(click)=\"removeInputField(i)\">\n\t\t\t\t\t\t<ion-icon slot=\"start\" name=\"close\"></ion-icon>\n\t\t\t\t\t\teliminar\n\t\t\t\t\t</ion-button>\n\t\t\t\t</ion-item-group>\n\t\t\t</section>\n\t\t</div>\n\t\t<!-- Allow new input field to be generated/added -->\n\t\t<ion-button size=\"small\" fill=\"clear\" color=\"primary\"\n\t\t\t(click)=\"addNewInputField()\">\n\t\t\t<ion-icon slot=\"start\" name=\"add\"></ion-icon>\n\t\t\tnuevo concepto\n\t\t\t</ion-button>\n\t\t<ion-button type=\"submit\" expand=\"block\" [disabled]=\"!fields.valid\">Agregar</ion-button>\n\t</form>\n</ion-content>\n","import { Component, OnInit } from '@angular/core';\nimport { FormArray, FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport {\n  ModalController,\n  LoadingController,\n  ActionSheetController,\n} from '@ionic/angular';\nimport { CategoriaDef, Concepto, Gastos, GastosDetalle } from '../../interface/gastos';\nimport { GastosService } from '../../service/gastos.service';\nimport { LoadingUtil } from '../../utils/loadingUtil';\nimport { ToastUtil } from 'src/app/utils/toastUtil';\n\n@Component({\n  selector: 'app-add-gastos',\n  templateUrl: 'add-gastos.component.html',\n  styleUrls: ['add-gastos.component.css'],\n  standalone: false,\n})\nexport class AddGastosComponent extends LoadingUtil implements OnInit {\n  gasto: Gastos = {};\n  gastoDetalle: GastosDetalle = {};\n  gastoDetalles: GastosDetalle [] = [];\n  conceptos: Concepto[] = [];\n  categorias: CategoriaDef[] = [];\n  date = new Date(); // Or the date you'd like converted.\n  today = new Date(\n    this.date.getTime() - this.date.getTimezoneOffset() * 60000\n  );\n  gastosConfirm: GastosDetalle[] = [];\n\n  public fields: FormGroup;\n\n  constructor(\n    public modalCtrl: ModalController,\n    private actionSheet: ActionSheetController,\n    private formBuilder: FormBuilder,\n    private service: GastosService,\n    loadingCtrl: LoadingController,\n    private toastCtrl: ToastUtil\n  ) {\n    super(loadingCtrl);\n    this.fields = this.formBuilder.group({\n      categoria: ['', Validators.required],\n      nombre: ['', Validators.required],\n      fecha: ['', Validators.required],\n      monto: ['', Validators.required],\n      comentario: [''],\n      conceptos: this.formBuilder.array([this.frmConceptos()])\n    });\n  }\n\n  frmConceptos(): FormGroup {\n    return this.formBuilder.group({\n      // concepto: ['', Validators.required],\n      mes: ['', Validators.required],\n      monto: ['', Validators.required],\n      comentario: ['']\n    });\n  }\n\n  get conceptoForm() {\n    return this.fields.get('conceptos') as FormArray;\n  }\n\n  logForm() {\n    console.log(this.fields.value);\n  }\n  ngOnInit() {\n    this.service.getSpreadSheetId().then(() => this.initCategorias());\n    const formattedDate = this.today.toJSON().split('T')[0];\n    this.fields.patchValue({ fecha: formattedDate });\n  }\n\n  initCategorias() {\n    this.showing();\n    this.service.getCategoriaDef().subscribe((resp: CategoriaDef[]) => {\n      this.categorias = resp || [];\n      this.dismiss();\n    });\n  }\n\n  onChange(event: CustomEvent) {\n    const _categoria: CategoriaDef = event.detail.value;\n    if (_categoria) {\n      let categoria: CategoriaDef;\n      categoria = this.categorias && this.categorias.find((data) => data.Nombre === _categoria.Nombre) || {} as CategoriaDef;\n      this.fields.patchValue({ nombre: categoria.PersonaServicio });\n    }\n  }\n\n    onChangeMonto(event: CustomEvent, i: number) {\n      const _monto: number = event.detail.value;\n      if (_monto) {\n        const control = <FormArray>this.fields.controls['conceptos'];\n        const newMonto = _monto - control.at(i).value.monto;\n        // const formattedDate = this.today.toJSON().split('T')[0];\n        const formattedDate = this.fields.value.fecha;\n        const _comentario = this.fields.value.comentario;\n        control.at(i).patchValue({\n          mes: formattedDate,\n          monto: _monto,\n          comentario: _comentario\n        });\n      }\n    }\n\n  async onSave(_gasto: any) {\n    const actionSheet = await this.actionSheet.create({\n      header: '¿Desea guardar el gasto?',\n      buttons: [\n        {\n          text: 'Guardar',\n          icon: 'save',\n          handler: () => {\n            this.save(_gasto);\n          },\n        },\n        {\n          text: 'Cancelar',\n          icon: 'close',\n          role: 'cancel',\n        },\n      ],\n  });\n    await actionSheet.present();\n}\n\n  save(_gasto: any) {\n    let fecha = new Date(this.gasto.Fecha || this.today);\n    this.gasto.Fecha = fecha.toLocaleString('es-MX', {\n      timeZone: 'America/Mexico_City'\n    });\n    this.fillEvent(_gasto);\n    this.service.save(this.gasto, this.gastoDetalles).subscribe({\n      next: (resp) => {\n        this.meesageToast('Se guardo exitosamente');\n        this.dismiss();\n        // this.confirm(this.gastoDetalles);\n        this.calOther(this.gastoDetalles);\n      },\n      error: (err) => {\n        this.meesageToast('No se pudo guardar el dato');\n        console.log('Error: ', err);\n        this.dismiss();\n      }\n    });\n    this.showing();\n  }\n\n    fillEvent(_gasto: any) {\n      // console.log(\"fillEvent\", _gasto);\n      this.gasto.Categoria = _gasto.categoria.Nombre;\n      this.gasto.Fecha = _gasto.fecha;\n      this.gasto.Nombre = _gasto.nombre;\n      this.gasto.Monto = _gasto.monto;\n      this.gasto.Comentario = _gasto.comentario;\n      // console.log(\"this.gastos\", this.gastos);\n      var conceptos = _gasto.conceptos;\n          this.gastoDetalles = [];\n          if (conceptos) {\n            conceptos.forEach((data: Concepto) => {\n            var detail: GastosDetalle = {};\n            detail.Categoria = _gasto.categoria.Nombre;\n            detail.Fecha = data.mes;\n            detail.Nombre = _gasto.nombre;\n            detail.Monto = data.monto;\n            detail.Comentario = data.comentario;\n              //console.log(\"detail\", detail);\n              this.gastoDetalles.push(detail);\n            });\n          }\n    }\n\n\n    async calOther(_gastosDetalle: any) {\n      const actionSheet = await this.actionSheet.create({\n        header: '¿Desea agregar otro gasto ?',\n        buttons: [\n          {\n            text: 'Otro gasto',\n            icon: 'add-outline',\n            role: 'other',\n            handler: () => {\n              this.gastosConfirm.push(..._gastosDetalle);\n              this.fields.reset();\n              const formattedDate = this.today.toJSON().split('T')[0];\n              this.fields.patchValue({ fecha: formattedDate });\n            },\n          },\n          {\n            text: 'Salir',\n            icon: 'checkmark',\n            role: 'confirm',\n            handler: () => {\n              this.gastosConfirm.push(..._gastosDetalle);\n              this.confirm(this.gastosConfirm);\n            },\n          },\n        ],\n      });\n      await actionSheet.present();\n    }\n\n    removeInputField(i: number): void {\n      const control = <FormArray>this.fields.controls['conceptos'];\n      control.removeAt(i);\n    }\n\n    addNewInputField(): void {\n      const control = <FormArray>this.fields.controls['conceptos'];\n      let sumMonto: number = 0;\n      control.controls.forEach((data: any) => {\n        sumMonto += data.value.monto;\n      });\n      control.push(this.frmConceptos());\n      this.updateMountConcepto(sumMonto);\n    }\n\n    updateMountConcepto(_monto: number = 0) {\n      const monto = this.fields.value.monto;\n      const newMonto = monto - _monto;\n      const control = <FormArray>this.fields.controls['conceptos'];\n      const formattedDate = this.today.toJSON().split('T')[0];\n      control.at(control.length -1 ).patchValue({\n        mes: formattedDate,\n        monto: newMonto\n      });\n    }\n\n\n  meesageToast(_message: string) {\n    this.toastCtrl.presentToast(_message, 'top');\n  }\n\n  close() {\n    this.modalCtrl.dismiss(null, 'cancel');\n  }\n  confirm(gasto : any) {\n    this.modalCtrl.dismiss(gasto, 'confirm');\n  }\n}\n","<ion-header [translucent]=\"true\">\n  <ion-toolbar color=\"primary\">\n    <ion-title>\n      Gastos\n    </ion-title>\n  </ion-toolbar>\n</ion-header>\n<ion-content class=\"ion-padding\">\n\t<!-- Botton Add -->\n\t<ion-fab slot=\"fixed\" vertical=\"bottom\" horizontal=\"end\" *ngIf=\"role != 'reader'\">\n\t\t<ion-fab-button (click)=\"openModal({new: 'Add'})\">\n\t\t  <ion-icon name=\"add\"></ion-icon>\n\t\t</ion-fab-button>\n\t  </ion-fab>\n\t<ion-list-header>\n\t\t<ion-searchbar (ionInput)=\"getItems($event)\"></ion-searchbar>\n\t</ion-list-header>\n\t<ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh($event)\">\n\t\t<ion-refresher-content pullingIcon=\"arrow-dropdown\" pullingText=\"Pull to refresh\" refreshingSpinner=\"circles\"\n\t\t\trefreshingText=\"Refrescando...\"></ion-refresher-content>\n\t</ion-refresher>\n\t<ion-item-group *ngFor=\"let item of items | groupBy:'Fecha':'reverse'\">\n\t\t<ion-item-divider color=\"light\">\n\t\t\t{{  item.header | date: 'MMM.dd.yy' }}\n\t\t</ion-item-divider>\n\t\t<ion-item *ngFor=\"let detail of item.details\">\n\t\t\t<ion-label>\n\t\t\t\t<div ion-text color=\"primary\">\n\t\t\t\t\t<h3>{{ detail.Nombre }} {{ detail.Comentario ? ' (' + detail.Comentario + ') ' : ''}}</h3>\n\t\t\t\t</div>\n\t\t\t\t<p>{{ detail.Categoria }} -- {{ detail.Monto | currency }} </p>\n\t\t\t</ion-label>\n\t\t</ion-item>\n\t</ion-item-group>\n</ion-content>\n","import { Component, OnInit } from '@angular/core';\nimport {\n  ModalController,\n  NavController\n} from '@ionic/angular';\nimport { AddGastosComponent } from '../../components/add-gastos/add-gastos.component';\nimport { GastosService } from '../../service/gastos.service';\nimport { LoadingUtil } from '../../utils/loadingUtil';\nimport { GastosDetalle } from '../../interface/gastos';\n\n@Component({\n  selector: 'app-gastos',\n  templateUrl: 'gastos.page.html',\n  styleUrls: ['gastos.page.scss'],\n  standalone: false,\n})\nexport class GastosPage implements OnInit {\n  items: GastosDetalle[] = [];\n  itemsBackup: GastosDetalle[] = [];\n  role: string = '';\n\n  constructor(\n    public modalCtrl: ModalController,\n    public navCtrl: NavController,\n    private service: GastosService,\n    private loadUtil: LoadingUtil\n  ) {\n  }\n\n  ngOnInit() {\n    this.service.getSpreadSheetId().then(() => this.getdata());\n    const user = localStorage.getItem('user');\n    this.role = user ? JSON.parse(user).ROLE : '';\n  }\n\n  doRefresh(event: CustomEvent) {\n    this.service.getFullDataDetail().subscribe((data: any[]) => {\n      this.items = [...data]; // Fuerza nueva referencia para refrescar la vista\n      this.itemsBackup = [...this.items];\n      (event.target as HTMLIonRefresherElement).complete();\n    });\n  }\n\n  async getdata() {\n    this.loadUtil.showing();\n    await this.service.getFullDataDetail().subscribe((data: GastosDetalle[]) => {\n      this.items = [...data]; // Fuerza nueva referencia para refrescar la vista\n      this.itemsBackup = [...this.items];\n      this.loadUtil.dismiss();\n    });\n  }\n\n  getItems(ev: any) {\n    // Reset items back to all of the items\n    // console.log(this.items);\n    this.items = this.itemsBackup;\n    // console.log(\"this.items\", this.items);\n    // set val to the value of the searchbar\n    const val = ev.target.value;\n    // if the value is an empty string don't filter the items\n    if (val && val.trim() != '') {\n      this.items = this.items.filter(item => {\n        return (\n          item.Categoria && item.Categoria.toLowerCase().indexOf(val.toLowerCase()) > -1 ||\n          item.Nombre && item.Nombre.toLowerCase().indexOf(val.toLowerCase()) > -1\n        );\n      });\n    }\n  }\n\n  async openModal(detail: any) {\n    const modal = await this.modalCtrl.create({\n      component: AddGastosComponent,\n      componentProps: { detail : detail.detail }\n    });\n    modal.present();\n    const { data, role } = await modal.onWillDismiss();\n    if (role === 'confirm' && data && Array.isArray(data)) {\n      this.items.push(...data);\n      this.items = [...this.items]; // Fuerza refresco de la vista\n      this.itemsBackup = [...this.items];\n      this.service.gastosDetalle$.next(this.items); // Actualiza el observable compartido\n    }\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { GastosPage } from './gastos.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: GastosPage,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class GastosPageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { GastosPage } from './gastos.page';\n\nimport { GastosPageRoutingModule } from './gastos-routing.module';\nimport { GroupByPipe } from 'src/app/pipes/group-by.pipe';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    GastosPageRoutingModule,\n    GroupByPipe\n  ],\n  declarations: [GastosPage]\n})\nexport class GastosPageModule {}\n"],"x_google_ignoreList":[]}